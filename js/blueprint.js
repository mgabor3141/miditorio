var str, obj;
function getBlueprint() {
	// Import decoder
	//str = "0eNrVWl1vmzAU/S9+JhM2HyFIrVRpz5u016lChDiNtWAiY9qhiv8+O6wJTTDYbsrYSxI+fA333HOu73VewXpf4QMjlIP4FZCsoCWIf76CkjzRdC/P8fqAQQwIxzlwAE1zebTBGdlgtsiKfE1oygsGGgcQusG/QQwbZ9SAnIinlPdbQM2jAzDlhBPcPs/xoE5ola8xE1MMGnLAoSjF2ILK+YW9he+AWn6JKTaE4ay9hhw5nLNin6zxLn0mYqwYsCV7jpnCD8+E8UqcOT1Ae8fiieFavkFWVNKXC9hxx+PxPKXtvKW0BuUHw5vuyxFx5Ik7Ccsqwo+HwhFNI9158f7oNH3KCN/lmJNs2APoS2Dig7PZRFzekNODbwkreaLtFpxmu9YtLUwgdh1QHDBL2+nB9x9iTFHxQ2VstVG4VUCB6YhjW1CQ8vbg+vY+HLwhRgyA4GmB8NfmxxCQBJcIlFia0R/ntrDlh5Qd3yYGdxZInWlxqJMjN5ItK/KEUGEGxJxVuNFnhy91oRcvdImX8+5ypES/Z5bLwYGRbRVlfTvJ8iaTrNsoloopgbFiuf9WsUz58ubNrrjd399c3LRyhh5J0CALQj1cQ1Nc4VwSUei9B+vh29cp0Ar05GJpJxdoMrlY2slFpBdWkWViRfNPrHCGiXWp1AxvOPlB1ySzXinVsDEVN1Z23IDTpVLPjhx93uxzgLzPih5w/vRAM6THSkmPaIQegQk9ohF6aKYOCI2iw1UER/ipwZFmv67qwg+jjp8xq/mO0KfbYS+9qbe8gt4lYGZlBxyJJc1CAyIzefR6M2d4Q3XsoH1daYjfZSJn3Kb7EpuU9MLfCg94Vh6An+mBVgwNSq3+V77SBKiZMezKT3e6lLmyTJmanRoY2KVMd/4Z05thxoTqVs31IucipEMj1XRHkmaoqZqhXXz8Bysqf47xoa444Ei/TSrF0HXkmrQ5tBdVdgX5dDUHCiwFVLPRAyOrVaU73aKyxvt98fJ+VYluEPkvO8LxQOi3CxcDj6+0V5TwIwtINEIMJdIr056eaySGt2rp+TZi+Cai3c7fwiIo3oLNaBPKMLVp9sqQZTdgwk2oDoVmX+9F2u30sU1EXWlFdtvZn7g15CqKFcfABuwmp87WvokN1LFx7ql5Rja8jg3/ZMM3suF3bJzzbGBk46FjI/JX/tJddtqEnlkh2K/lspiWf7OIO3/rcIAgSdkmX99HQRBErlh9NX8AqD6i/A==";
	//obj = JSON.parse(String.fromCharCode.apply(null, pako.inflate(base64js.toByteArray(str.slice(1)))));
	//console.log(obj);

	var signals = song.toFactorio();

	console.log(signals);

	entities = [{"entity_number":1,"name":"constant-combinator","position":{"x":-4,"y":-4},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-grey"},"count":-1,"index":1}]},"connections":{"1":{"red":[{"entity_id":3,"circuit_id":2}]}}},{"entity_number":2,"name":"arithmetic-combinator","position":{"x":-2.5,"y":-4},"direction":2,"control_behavior":{"arithmetic_conditions":{"first_signal":{"type":"virtual","name":"signal-each"},"constant":0,"operation":"OR","output_signal":{"type":"virtual","name":"signal-each"}}},"connections":{"1":{"green":[{"entity_id":3,"circuit_id":1}]},"2":{"green":[{"entity_id":5,"circuit_id":1}]}}},{"entity_number":3,"name":"decider-combinator","position":{"x":-2.5,"y":-3},"direction":2,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-blue"},"second_signal":{"type":"virtual","name":"signal-0"},"comparator":"=","output_signal":{"type":"virtual","name":"signal-grey"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":4}],"green":[{"entity_id":2,"circuit_id":1},{"entity_id":8,"circuit_id":1}]},"2":{"red":[{"entity_id":1},{"entity_id":5,"circuit_id":1},{"entity_id":8,"circuit_id":2}]}}},{"entity_number":4,"name":"constant-combinator","position":{"x":-4,"y":-3},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-grey"},"count":1,"index":1}]},"connections":{"1":{"red":[{"entity_id":3,"circuit_id":1}]}}},{"entity_number":5,"name":"arithmetic-combinator","position":{"x":-0.5,"y":-4},"direction":2,"control_behavior":{"arithmetic_conditions":{"first_signal":{"type":"virtual","name":"signal-each"},"second_signal":{"type":"virtual","name":"signal-grey"},"operation":">>","output_signal":{"type":"virtual","name":"signal-each"}}},"connections":{"1":{"red":[{"entity_id":3,"circuit_id":2}],"green":[{"entity_id":2,"circuit_id":2}]},"2":{"red":[{"entity_id":6,"circuit_id":1}]}}},{"entity_number":6,"name":"arithmetic-combinator","position":{"x":1.5,"y":-4},"direction":2,"control_behavior":{"arithmetic_conditions":{"first_signal":{"type":"virtual","name":"signal-each"},"constant":63,"operation":"AND","output_signal":{"type":"virtual","name":"signal-each"}}},"connections":{"1":{"red":[{"entity_id":5,"circuit_id":2}]}}},{"entity_number":7,"name":"constant-combinator","position":{"x":-4,"y":-2},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-grey"},"count":7,"index":1}]},"connections":{"1":{"red":[{"entity_id":8,"circuit_id":1}]}}},{"entity_number":8,"name":"decider-combinator","position":{"x":-2.5,"y":-2},"direction":2,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-blue"},"second_signal":{"type":"virtual","name":"signal-1"},"comparator":"=","output_signal":{"type":"virtual","name":"signal-grey"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":7}],"green":[{"entity_id":3,"circuit_id":1},{"entity_id":10,"circuit_id":1}]},"2":{"red":[{"entity_id":3,"circuit_id":2},{"entity_id":10,"circuit_id":2}]}}},{"entity_number":9,"name":"constant-combinator","position":{"x":-4,"y":-1},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-grey"},"count":13,"index":1}]},"connections":{"1":{"red":[{"entity_id":10,"circuit_id":1}]}}},{"entity_number":10,"name":"decider-combinator","position":{"x":-2.5,"y":-1},"direction":2,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-blue"},"second_signal":{"type":"virtual","name":"signal-2"},"comparator":"=","output_signal":{"type":"virtual","name":"signal-grey"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":9}],"green":[{"entity_id":8,"circuit_id":1},{"entity_id":15,"circuit_id":1}]},"2":{"red":[{"entity_id":8,"circuit_id":2},{"entity_id":15,"circuit_id":2}]}}},{"entity_number":11,"name":"decider-combinator","position":{"x":0.5,"y":-1},"direction":6,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-black"},"constant":0,"comparator":"=","output_signal":{"type":"virtual","name":"signal-everything"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":11,"circuit_id":2}],"green":[{"entity_id":13},{"entity_id":18,"circuit_id":1}]},"2":{"red":[{"entity_id":11,"circuit_id":1},{"entity_id":18,"circuit_id":2}]}}},{"entity_number":12,"name":"constant-combinator","position":{"x":3,"y":-2},"direction":6,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-black"},"count":1,"index":1}],"is_on":false},"connections":{"1":{"green":[{"entity_id":13}]}}},{"entity_number":13,"name":"constant-combinator","position":{"x":3,"y":-1},"direction":6,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-blue"},"count":1,"index":1}]},"connections":{"1":{"green":[{"entity_id":12},{"entity_id":11,"circuit_id":1}]}}},{"entity_number":14,"name":"constant-combinator","position":{"x":-4,"y":0},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-grey"},"count":19,"index":1}]},"connections":{"1":{"red":[{"entity_id":15,"circuit_id":1}]}}},{"entity_number":15,"name":"decider-combinator","position":{"x":-2.5,"y":0},"direction":2,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-blue"},"second_signal":{"type":"virtual","name":"signal-3"},"comparator":"=","output_signal":{"type":"virtual","name":"signal-grey"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":14}],"green":[{"entity_id":10,"circuit_id":1},{"entity_id":16,"circuit_id":1}]},"2":{"red":[{"entity_id":10,"circuit_id":2},{"entity_id":16,"circuit_id":2}]}}},{"entity_number":16,"name":"decider-combinator","position":{"x":-2.5,"y":1},"direction":2,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-blue"},"second_signal":{"type":"virtual","name":"signal-4"},"comparator":"=","output_signal":{"type":"virtual","name":"signal-grey"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":17}],"green":[{"entity_id":15,"circuit_id":1},{"entity_id":19,"circuit_id":1},{"entity_id":20,"circuit_id":2}]},"2":{"red":[{"entity_id":15,"circuit_id":2}]}}},{"entity_number":17,"name":"constant-combinator","position":{"x":-4,"y":1},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-grey"},"count":25,"index":1}]},"connections":{"1":{"red":[{"entity_id":16,"circuit_id":1}]}}},{"entity_number":18,"name":"decider-combinator","position":{"x":0.5,"y":0},"direction":6,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-yellow"},"constant":2,"comparator":"=","output_signal":{"type":"virtual","name":"signal-white"},"copy_count_from_input":false}},"connections":{"1":{"red":[{"entity_id":19,"circuit_id":2}],"green":[{"entity_id":11,"circuit_id":1}]},"2":{"red":[{"entity_id":11,"circuit_id":2},{"entity_id":20,"circuit_id":1}]}}},{"entity_number":19,"name":"arithmetic-combinator","position":{"x":0.5,"y":1},"direction":2,"control_behavior":{"arithmetic_conditions":{"first_signal":{"type":"virtual","name":"signal-4"},"second_signal":{"type":"virtual","name":"signal-blue"},"operation":"-","output_signal":{"type":"virtual","name":"signal-yellow"}}},"connections":{"1":{"green":[{"entity_id":16,"circuit_id":1}]},"2":{"red":[{"entity_id":18,"circuit_id":1}]}}},{"entity_number":20,"name":"decider-combinator","position":{"x":-2.5,"y":3},"direction":2,"control_behavior":{"decider_conditions":{"first_signal":{"type":"virtual","name":"signal-white"},"constant":0,"comparator":"=","output_signal":{"type":"virtual","name":"signal-everything"},"copy_count_from_input":true}},"connections":{"1":{"red":[{"entity_id":18,"circuit_id":2}],"green":[{"entity_id":21}]},"2":{"green":[{"entity_id":16,"circuit_id":1}]}}},{"entity_number":21,"name":"constant-combinator","position":{"x":-4,"y":3},"direction":2,"control_behavior":{"filters":[{"signal":{"type":"virtual","name":"signal-0"},"count":1,"index":1},{"signal":{"type":"virtual","name":"signal-1"},"count":2,"index":2},{"signal":{"type":"virtual","name":"signal-2"},"count":3,"index":3},{"signal":{"type":"virtual","name":"signal-3"},"count":4,"index":4},{"signal":{"type":"virtual","name":"signal-4"},"count":5,"index":5},{"signal":{"type":"virtual","name":"signal-A"},"count":84947073,"index":13}]},"connections":{"1":{"green":[{"entity_id":20,"circuit_id":1}]}}}];
	label = "MIDI File Name";
	bp = {"blueprint": {"icons": [{"signal":{"type":"item","name":"programmable-speaker"},"index":1}], "entities": entities, "item": "blueprint", "label": label, "version": 64425558017}};

	bpstring = "0" + base64js.fromByteArray(pako.deflate(JSON.stringify(bp)));

	$("#bpstring").text(bpstring);
	$("#blueprint").fadeIn().css("display","");
}

$("#getbp").click(getBlueprint);
